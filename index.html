<!doctype html>
<html>
  <head>
    <title>Hive Vote Tool</title>
    <style>
      body {
        font-family: Arial;
        margin: 50px;
      }
      input,
      select,
      button {
        padding: 10px;
        width: 320px;
        margin-bottom: 10px;
      }
      #status, #accountInfo {
        margin-top: 10px;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h2>Hive Blog Voter</h2>

    <input type="text" id="linkInput" placeholder="Paste Hive post link here" />
    <br />

    <select id="weightSelect">
      <option value="2500">25%</option>
      <option value="5000" selected>50%</option>
      <option value="7500">75%</option>
      <option value="10000" selected>100%</option>
    </select>
    <br />

    <button onclick="vote()">Vote</button>

    <p id="status"></p>
    <p id="accountInfo"></p>

    <script>
      async function vote() {
        const link = document.getElementById("linkInput").value;
        const weight = document.getElementById("weightSelect").value;

        const response = await fetch("/vote", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ link, weight }),
        });

        const result = await response.text();
        document.getElementById("status").innerText = result;

        loadAccountInfo();
      }

    async function loadAccountInfo() {
  try {
    const res = await fetch('/account');
    const data = await res.json();
    if (data.error) throw new Error(data.error);
    document.getElementById('accountInfo').innerText =
      `@${data.username} â€” Voting Power: ${data.voting_power}`;
  } catch (e) {
    document.getElementById('accountInfo').innerText =
      'Could not load account info.';
  }
}

      window.addEventListener('DOMContentLoaded', loadAccountInfo);
    </script>
  </body>
</html>
